<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>مواقف برج مجدول</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family:Tahoma, Arial;
    background:#f4f6f9;
}

header{
    background:#fff;
    padding:14px 20px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    box-shadow:0 2px 6px rgba(0,0,0,.1);
    font-weight:bold;
}

header h1{
    margin:0;
    font-size:20px;
    text-align:center;
    flex:1;
}

header img{height:38px}

.container{
    max-width:900px;
    margin:20px auto;
    background:#fff;
    padding:20px;
    border-radius:14px;
}

.search-box{
    display:flex;
    flex-direction:column;
    gap:12px;
    align-items:center;
    margin-bottom:15px;
}

.search-box input{
    width:100%;
    max-width:350px;
    padding:14px;
    text-align:center;
    border-radius:10px;
    border:1px solid #ccc;
    font-size:16px;
}

.counter{
    text-align:center;
    font-weight:bold;
    margin:10px 0;
}

.cards{
    display:flex;
    flex-direction:column;
    gap:14px;
}

.card{
    padding:16px;
    border-radius:14px;
    background:#f7f7f7;
    box-shadow:0 4px 10px rgba(0,0,0,.08);
    border-right:8px solid #1b7f3a;
}

.card.inactive{
    border-right-color:#b30000;
}

.card h3{
    margin:0 0 6px;
    font-size:18px;
}

.company{
    font-weight:bold;
    margin-bottom:6px;
}

.status{
    display:inline-block;
    padding:8px 18px;
    border-radius:20px;
    font-weight:bold;
}

.status.active{
    background:#e6f7ed;
    color:#1b7f3a;
}

.status.inactive{
    background:#fdeaea;
    color:#b30000;
}

footer{
    text-align:center;
    padding:15px;
    font-weight:bold;
    color:#666;
}
</style>
</head>

<body>

<header>
    <img src="Majdoul.png">
    <h1>مواقف برج مجدول</h1>
    <img src="linkexpert.png">
</header>

<div class="container">

<div class="search-box">
    <input id="plateInput" placeholder="البحث برقم أو حروف اللوحة">
    <input id="nameInput" placeholder="البحث باسم الموظف">
</div>

<div class="counter" id="counter"></div>
<div class="cards" id="cards"></div>

</div>

<footer>خبير الربط – Link Expert</footer>

<script>
let carsData = [];

function normalizePlate(t){
    return t?.toString().replace(/\s+/g,'').toUpperCase();
}
function normalizeName(t){
    return t?.toString().trim().toUpperCase();
}

fetch('تحديث بيانات الشركات (1).csv')
.then(r=>r.text())
.then(data=>{
    const lines=data.split('\n');
    const headers=lines[0].split(',');
    for(let i=1;i<lines.length;i++){
        if(!lines[i]) continue;
        const v=lines[i].split(',');
        let o={};
        headers.forEach((h,j)=>o[h.trim()]=v[j]?.trim());
        carsData.push(o);
    }
});

const plateInput=document.getElementById('plateInput');
const nameInput=document.getElementById('nameInput');
const cards=document.getElementById('cards');
const counter=document.getElementById('counter');

plateInput.addEventListener('input', ()=>{
    nameInput.value='';
    const v=normalizePlate(plateInput.value);
    render(carsData.filter(c =>
        normalizePlate(c['Car No. (English)']).includes(v) ||
        normalizePlate(c['Car No. (Arabic)']).includes(v)
    ));
});

nameInput.addEventListener('input', ()=>{
    plateInput.value='';
    const v=normalizeName(nameInput.value);
    render(carsData.filter(c =>
        normalizeName(c['Employee Name']).includes(v)
    ));
});

function render(results){
    cards.innerHTML='';
    counter.textContent=results.length?`عدد النتائج: ${results.length}`:'';

    results.forEach(car=>{
        const inactive=normalizeName(car['Status'])==='INACTIVE';

        cards.innerHTML+=`
        <div class="card ${inactive?'inactive':''}">
            <h3>${car['Employee Name']||'-'}</h3>
            <div class="company">${car['Client']||'-'}</div>
            اللوحة: ${car['Car No. (English)']||car['Car No. (Arabic)']||'-'}<br>
            اللون: ${car['Car Color']||'-'} | الموديل: ${car['Car Model']||'-'}<br><br>
            <span class="status ${inactive?'inactive':'active'}">
                ${inactive?'غير نشط':'نشط'}
            </span>
        </div>`;
    });
}
</script>

</body>
</html>
